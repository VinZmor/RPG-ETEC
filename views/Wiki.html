{% extends 'base.html' %}

{% block content %}
<style>
        :root {
            --primary: #3a86ff;
            --primary-dark: #2563eb;
            --primary-light: #93c5fd;
            --secondary: #f59e0b;
            --bg-color: #f8fafc;
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --text-color: #334155;
            --border-color: #e2e8f0;
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Layout Principal */
        #fundo {
            min-height: calc(100vh - 150px);
            position: relative;
        }

        /* Sidebar de Navegação */
        #sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem 1rem;
            overflow-y: auto;
            transition: var(--transition);
            height: calc(100vh - 76px);
            position: sticky;
            top: 76px;
        }

        #sidebar .h5 {
            color: var(--primary);
            font-weight: 700;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary-light);
        }

        #sidebar .nav-item {
            margin-bottom: 0.25rem;
        }

        #sidebar .nav-link {
            color: var(--text-color);
            padding: 0.6rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            position: relative;
        }

        #sidebar .nav-link:hover {
            background-color: var(--primary-light);
            color: blue;
        }

        #sidebar .nav-link.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        #sidebar .nav-link i {
            margin-right: 0.75rem;
            font-size: 0.9rem;
            width: 20px;
            text-align: center;
        }

        #sidebar .nav-link::after {
            content: '\f107';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 1rem;
            transition: transform 0.3s ease;
        }

        #sidebar .nav-link[aria-expanded="true"]::after {
            transform: rotate(180deg);
        }

        #sidebar .nav.flex-column.ms-3 {
            border-left: 2px solid var(--primary-light);
            padding-left: 0.5rem;
            margin-left: 1.25rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        #sidebar .nav.flex-column.ms-3 .nav-link {
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
        }

        /* Conteúdo Principal */
        #content {
            padding: 2rem;
            width: calc(100% - 280px);
            background-color: var(--bg-color);
            transition: var(--transition);
        }

        .content-section {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sistema de Filtros */
        .filter-container {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary);
        }

        .filter-group {
            margin-bottom: 1rem;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }

        .filter-badge {
            cursor: pointer;
            margin: 0.25rem;
            transition: var(--transition);
        }

        .filter-badge:hover {
            transform: translateY(-2px);
        }

        /* Cards para conteúdo */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .info-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            border-left: 4px solid var(--primary);
            height: 100%;
            transition: var(--transition);
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .info-card h4 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.2rem;
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 0.5rem;
        }

        .info-card .card-text {
            line-height: 1.6;
        }

        .info-card .card-meta {
            font-size: 0.9rem;
            color: #64748b;
            margin-top: 1rem;
        }

        .no-results {
            text-align: center;
            padding: 2rem;
            background-color: white;
            border-radius: 8px;
            grid-column: 1 / -1;
        }

        /* Responsividade */
        @media (max-width: 992px) {
            #fundo {
                flex-direction: column;
            }
            
            #sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            #content {
                width: 100%;
            }

            .card-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 576px) {
            #content {
                padding: 1rem;
            }
            
            .card-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    
    <div id="fundo" class="d-flex">
        <!-- Sidebar de Navegação -->
        <nav id="sidebar">
            <span class="h5">Vale Místico</span>
            
            <ul class="nav flex-column mt-3">
                <li class="nav-item">
                    <a href="#" data-id="introducao" class="nav-link active">
                        <i class="fas fa-home"></i> Introdução
                    </a>
                    <ul id="introducao-sub" class="nav flex-column ms-3">
                        <li class="nav-item"><a href="#" data-id="rpg" class="nav-link">RPG</a></li>
                        <li class="nav-item"><a href="#" data-id="interpretacao" class="nav-link">Interpretação</a></li>
                        <li class="nav-item"><a href="#" data-id="seuPersonagem" class="nav-link">Seu Personagem</a></li>
                        <li class="nav-item"><a href="#" data-id="narrando" class="nav-link">Narrando</a></li>
                        <li class="nav-item"><a href="#" data-id="ficha" class="nav-link">Preenchendo sua Ficha</a></li>
                        <li class="nav-item"><a href="#" data-id="equipamento" class="nav-link">Equipamento</a></li>
                        <li class="nav-item"><a href="#" data-id="levelUp" class="nav-link">Subindo de Nível</a></li>
                        <li class="nav-item"><a href="#" data-id="habilidade" class="nav-link">Habilidades</a></li>
                        <li class="nav-item"><a href="#" data-id="glossario" class="nav-link">Glossário</a></li>
                        <li class="nav-item"><a href="#" data-id="bestiario" class="nav-link">Bestiário</a></li>
                    </ul>
                </li>
                
                <li class="nav-item">
                    <a href="#" data-id="bestiario" class="nav-link">
                        <i class="fas fa-dragon"></i> Bestiário
                    </a>
                    <ul id="bestiario-sub" class="nav flex-column ms-3 d-none">
                        {% for bestiario in rpg_bestiario %}
                        <li class="nav-item">
                            <a href="#" data-id="bestiario-{{ bestiario.id }}" class="nav-link">{{ bestiario.nome }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="#" data-id="antepassados" class="nav-link">
                        <i class="fas fa-history"></i> Antepassados
                    </a>
                    <ul id="antepassados-sub" class="nav flex-column ms-3 d-none">
                        {% for antepassado in rpg_antepassado %}
                        <li class="nav-item">
                            <a href="#" data-id="antepassado-{{ antepassado.id }}" class="nav-link">{{ antepassado.nome }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="#" data-id="equipamentos" class="nav-link">
                        <i class="fas fa-shield-alt"></i> Equipamentos
                    </a>
                    <ul id="equipamentos-sub" class="nav flex-column ms-3 d-none">
                        {% for equipamento in rpg_equipamento %}
                        <li class="nav-item">
                            <a href="#" data-id="equipamento-{{ equipamento.id }}" class="nav-link">{{ equipamento.nome }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="#" data-id="habilidades" class="nav-link">
                        <i class="fas fa-fire"></i> Habilidades
                    </a>
                    <ul id="habilidades-sub" class="nav flex-column ms-3 d-none">
                        {% for habilidade in rpg_habilidade %}
                        <li class="nav-item">
                            <a href="#" data-id="habilidade-{{ habilidade.id }}" class="nav-link">{{ habilidade.nome }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="#" data-id="poderes" class="nav-link">
                        <i class="fas fa-magic"></i> Poderes
                    </a>
                    <ul id="poderes-sub" class="nav flex-column ms-3 d-none">
                        {% for poder in rpg_poder %}
                        <li class="nav-item">
                            <a href="#" data-id="poder-{{ poder.id }}" class="nav-link">{{ poder.nome }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- Conteúdo Principal -->
        <main id="content" class="flex-grow">
            <!-- Sistema de Filtros -->
            <div class="filter-container d-none" id="filterSection">
                <div class="row">
                    <div class="col-md-6">
                        <div class="filter-group">
                            <label for="searchInput"><i class="fas fa-search"></i> Buscar</label>
                            <input type="text" id="searchInput" class="form-control" placeholder="Digite para buscar...">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="filter-group">
                            <label for="sortSelect"><i class="fas fa-sort"></i> Ordenar por</label>
                            <select id="sortSelect" class="form-select">
                                <option value="name">Nome (A-Z)</option>
                                <option value="name-desc">Nome (Z-A)</option>
                            </select>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- Conteúdo das Seções -->
            <div class="content-section" data-content="introducao">
                <h1 class="text-primary mb-4">Introdução ao Vale Místico</h1>
                <p>Bem-vindo ao mundo de Vale Místico, um RPG de fantasia onde você pode criar personagens incríveis, explorar mundos misteriosos e viver aventuras épicas.</p>
                
                    
            </div>

            <!-- Seções de conteúdo dinâmico -->
            <div class="content-section d-none" data-content="bestiario">
                <h1 class="text-primary mb-4">Bestiário</h1>
                <p>Explore as criaturas e monstros que habitam o mundo de Vale Místico.</p>
                
                <div class="card-container" id="bestiario-content">
                    {% for bestiario in rpg_bestiario %}
                    <div class="info-card" data-name="{{ bestiario.nome|lower }}">
                        <h4>{{ bestiario.nome }}</h4>
                        <p class="card-text">{{ bestiario.descricao }}</p>
                        <div class="card-meta">
                            <span class="badge bg-primary">ND: {{ bestiario.nd }}</span>
                            <span class="badge bg-info ms-1">Vida: {{ bestiario.vida }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="content-section d-none" data-content="antepassados">
                <h1 class="text-primary mb-4">Antepassados</h1>
                <p>Descubra as linhagens e histórias que moldaram seus personagens.</p>
                
                <div class="card-container" id="antepassados-content">
                    {% for antepassado in rpg_antepassado %}
                    <div class="info-card" data-name="{{ antepassado.nome|lower }}">
                        <h4>{{ antepassado.nome }}</h4>
                        <p class="card-text">{{ antepassado.descricao }}</p>
                        <div class="card-meta">
                            <span class="badge bg-success">Perícias: {{ antepassado.pericia }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="content-section d-none" data-content="equipamentos">
                <h1 class="text-primary mb-4">Equipamentos</h1>
                <p>Armas, armaduras e itens para equipar seus personagens.</p>
                
                <div class="card-container" id="equipamentos-content">
                    {% for equipamento in rpg_equipamento %}
                    <div class="info-card" data-name="{{ equipamento.nome|lower }}">
                        <h4>{{ equipamento.nome }}</h4>
                        <p class="card-text">{{ equipamento.descricao }}</p>
                        <div class="card-meta">
                            <span class="badge bg-info">Custo: {{ equipamento.custo }}</span>
                            <span class="badge bg-secondary ms-1">Volume: {{ equipamento.volume }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="content-section d-none" data-content="habilidades">
                <h1 class="text-primary mb-4">Habilidades</h1>
                <p>Técnicas e capacidades que seus personagens podem aprender.</p>
                
                <div class="card-container" id="habilidades-content">
                    {% for habilidade in rpg_habilidade %}
                    <div class="info-card" data-name="{{ habilidade.nome|lower }}">
                        <h4>{{ habilidade.nome }}</h4>
                        <p class="card-text">{{ habilidade.descricao }}</p>
                        <div class="card-meta">
                            <span class="badge bg-warning text-dark">Condição: {{ habilidade.condicao }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="content-section d-none" data-content="poderes">
                <h1 class="text-primary mb-4">Poderes</h1>
                <p>Habilidades especiais e poderes mágicos para seus personagens.</p>
                
                <div class="card-container" id="poderes-content">
                    {% for poder in rpg_poder %}
                    <div class="info-card" data-name="{{ poder.nome|lower }}">
                        <h4>{{ poder.nome }}</h4>
                        <p class="card-text">{{ poder.descricao }}</p>
                        <div class="card-meta">
                            <span class="badge bg-info">Requisito: {{ poder.requisito }}</span>
                            <span class="badge bg-secondary ms-1">Custo: {{ poder.custo }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Seções de conteúdo estático -->
            <div class="content-section d-none" data-content="rpg">
                <h1 class="text-primary mb-4">O que é RPG?</h1>
                <p>Um jogo de RPG (Role-Playing Game), traduzido para jogo interpretativo, tem uma estrutura relativamente simples. O Mestre funciona como o narrador de história, e geralmente deve ser o participante mais experiente (caso haja um).</p>
            </div>

            <!-- Outras seções de conteúdo estático... -->
            
            <!-- Seções de conteúdo individual -->
            {% for bestiario in rpg_bestiario %}
            <div class="content-section d-none" data-content="bestiario-{{ bestiario.id }}">
                <h1 class="text-primary">{{ bestiario.nome }}</h1>
                <p><strong>Descrição:</strong> {{ bestiario.descricao }}</p>
                <p><strong>ND:</strong> {{ bestiario.nd }}</p>
                <p><strong>Atributos:</strong> {{ bestiario.atributos }}</p>
                <p><strong>Perícias:</strong> {{ bestiario.pericias }}</p>
                <p><strong>Velocidade:</strong> {{ bestiario.velocidade }}</p>
                <p><strong>Vida:</strong> {{ bestiario.vida }}</p>
                <p><strong>Mental:</strong> {{ bestiario.mental }}</p>
                <p><strong>Energia:</strong> {{ bestiario.energia }}</p>
            </div>
            {% endfor %}

            {% for antepassado in rpg_antepassado %}
            <div class="content-section d-none" data-content="antepassado-{{ antepassado.id }}">
                <h1 class="text-primary">{{ antepassado.nome }}</h1>
                <p><strong>Descrição:</strong> {{ antepassado.descricao }}</p>
                <p><strong>Perícias:</strong> {{ antepassado.pericia }}</p>
                <p><strong>Equipamento:</strong> {{ antepassado.equipamento }}</p>
                <p><strong>Crédito:</strong> {{ antepassado.credito }}</p>
            </div>
            {% endfor %}

            {% for equipamento in rpg_equipamento %}
            <div class="content-section d-none" data-content="equipamento-{{ equipamento.id }}">
                <h1 class="text-primary">{{ equipamento.nome }}</h1>
                <p><strong>Descrição:</strong> {{ equipamento.descricao }}</p>
                <p><strong>Custo:</strong> {{ equipamento.custo }}</p>
                <p><strong>Volume:</strong> {{ equipamento.volume }}</p>
            </div>
            {% endfor %}

            {% for habilidade in rpg_habilidade %}
            <div class="content-section d-none" data-content="habilidade-{{ habilidade.id }}">
                <h1 class="text-primary">{{ habilidade.nome }}</h1>
                <p><strong>Condição:</strong> {{ habilidade.condicao }}</p>
                <p><strong>Descrição:</strong> {{ habilidade.descricao }}</p>
            </div>
            {% endfor %}

            {% for poder in rpg_poder %}
            <div class="content-section d-none" data-content="poder-{{ poder.id }}">
                <h1 class="text-primary">{{ poder.nome }}</h1>
                <p><strong>Requisito:</strong> {{ poder.requisito }}</p>
                <p><strong>Custo:</strong> {{ poder.custo }}</p>
                <p><strong>Uso:</strong> {{ poder.uso }}</p>
                <p><strong>Descrição:</strong> {{ poder.descricao }}</p>
            </div>
            {% endfor %}
        </main>
    </div>

    <script>
        // Função para aplicar filtros
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sortValue = document.getElementById('sortSelect').value;
            
            // Determinar qual seção está ativa
            const activeSection = document.querySelector('.content-section:not(.d-none)');
            const sectionType = activeSection.dataset.content;
            
            // Apenas aplicar filtros nas seções de listagem
            if (!['bestiario', 'antepassados', 'equipamentos', 'habilidades', 'poderes'].includes(sectionType)) {
                return;
            }
            
            // Obter os cards da seção atual
            const cards = activeSection.querySelectorAll('.info-card');
            let visibleCards = 0;
            
            // Aplicar filtro de busca
            cards.forEach(card => {
                const cardName = card.dataset.name;
                const isVisible = !searchTerm || cardName.includes(searchTerm);
                
                card.style.display = isVisible ? 'block' : 'none';
                if (isVisible) visibleCards++;
            });
            
            // Mostrar mensagem se não houver resultados
            const noResults = activeSection.querySelector('.no-results');
            if (visibleCards === 0) {
                if (!noResults) {
                    const noResultsElement = document.createElement('div');
                    noResultsElement.className = 'no-results';
                    noResultsElement.innerHTML = `
                        <i class="fas fa-search fa-3x mb-3 text-muted"></i>
                        <h4>Nenhum resultado encontrado</h4>
                        <p>Tente ajustar os filtros para ver mais resultados.</p>
                    `;
                    activeSection.querySelector('.card-container').appendChild(noResultsElement);
                }
            } else if (noResults) {
                noResults.remove();
            }
            
            // Aplicar ordenação (precisa ser implementada se necessário)
            // Esta é uma implementação simplificada - para ordenação real, precisaríamos
            // rearranjar os elementos no DOM
        }

        // Inicializar a página
        document.addEventListener('DOMContentLoaded', function() {
            // Adicionar event listeners para os filtros
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('sortSelect').addEventListener('change', applyFilters);
            
            
          
        });

        // Função para navegação entre seções
        function showContent(id) {
            // Esconde todas as seções
            document.querySelectorAll('.content-section').forEach(sec => {
                sec.classList.add('d-none');
            });
            
            // Mostra a seção correspondente
            const targetSection = document.querySelector(`[data-content="${id}"]`);
            if (targetSection) {
                targetSection.classList.remove('d-none');
                
                // Mostra/oculta a seção de filtros baseado no tipo de conteúdo
                const filterSection = document.getElementById('filterSection');
                if (['bestiario', 'antepassados', 'equipamentos', 'habilidades', 'poderes'].includes(id)) {
                    filterSection.classList.remove('d-none');
                    // Aplicar filtros ao mudar de seção
                    setTimeout(applyFilters, 100);
                } else {
                    filterSection.classList.add('d-none');
                }
            }
        }

        // Event listeners para navegação
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', e => {
                
                
                const id = link.dataset.id;
                if (!id) return;

                // Alterna visibilidade do submenu correspondente
                const submenu = document.getElementById(`${id}-sub`);
                const isVisible = submenu && !submenu.classList.contains('d-none');

                // Esconde todos os submenus
                document.querySelectorAll('nav ul[id$="-sub"]').forEach(sub => {
                    sub.classList.add('d-none');
                });

                // Atualiza a classe ativa no menu
                document.querySelectorAll('.nav-link').forEach(nav => {
                    nav.classList.remove('active');
                });
                link.classList.add('active');

                // Exibe a seção de conteúdo correspondente
                showContent(id);

                // Se existir e não estava visível, exibe este submenu
                if (submenu && !isVisible) {
                    submenu.classList.remove('d-none');
                }
            });
        });

        // Inicializar a primeira seção
        showContent('introducao');
    </script>

{% endblock content %}